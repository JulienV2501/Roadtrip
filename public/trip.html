<!doctype html>
<html lang="fr">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Roadtrip</title>
  <link rel="stylesheet" href="styles.css" />
  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
</head>
<body>
  <header class="topbar">
    <div class="topbar__left">
      <a class="link" href="index.html">‚Üê Retour hub</a>
      <h1 id="tripTitle">Roadtrip</h1>
      <p id="tripMeta" class="muted small"></p>
    </div>
    <div class="topbar__right">
      <div id="authState" class="muted">...</div>
      <button id="btnLogout" class="btn btn--ghost" style="display:none;">Se d√©connecter</button>
    </div>
  </header>

  <main class="container triplayout">
    <aside class="sidebar card">
      <div class="row row--between row--center">
        <h2>Navigation</h2>
        <button id="btnSave" class="btn btn--secondary">Sauvegarder</button>
      </div>
      <div class="muted small" id="saveState"></div>

      <div class="divider"></div>

      <button class="navitem navitem--active" data-view="summary">üìå R√©capitulatif</button>
      <div id="daysNav"></div>

      <div class="divider"></div>

      <div class="row">
        <button id="btnAddDay" class="btn btn--ghost">+ Ajouter un jour</button>
      </div>
    </aside>

    <section class="content">
      <section id="viewSummary" class="card view">
        <h2>R√©capitulatif du trip</h2>
        <p class="muted small">Carte : tous les trajets (segments) du trip + totaux.</p>

        <div id="mapSummary" class="map"></div>

        <div class="grid2">
          <div class="card inner">
            <h3>Totaux</h3>
            <div class="kv">
              <div><span class="muted">Km</span><strong id="sumKm">0</strong></div>
              <div><span class="muted">Heures de route</span><strong id="sumHours">0</strong></div>
              <div><span class="muted">D√©penses</span><strong id="sumCost">0</strong></div>
            </div>
          </div>

          <div class="card inner">
            <h3>Par jour</h3>
            <div id="perDayList" class="list smalllist"></div>
          </div>
        </div>
      </section>

      <section id="viewDay" class="card view" style="display:none;">
        <div class="row row--between row--center">
          <div>
            <h2 id="dayTitle">Jour</h2>
            <p class="muted small" id="daySubtitle"></p>
          </div>
          <div class="row">
            <button id="btnDeleteDay" class="btn btn--danger">Supprimer</button>
          </div>
        </div>

        <div class="grid2">
          <div class="card inner">
            <h3>√âtapes & trajet</h3>
            <p class="muted small">Ajoute des √©tapes (A ‚Üí B ‚Üí C) : la carte trace la polyline (simple). Pour un vrai routage, il faudra brancher un service de directions.</p>
            <div id="mapDay" class="map"></div>

            <div class="row">
              <label class="field field--grow">
                <span>√âtapes (1 par ligne)</span>
                <textarea id="stopsInput" rows="5" placeholder="D√©part\n√âtape 1\nArriv√©e"></textarea>
              </label>
            </div>

            <div class="grid3">
              <label class="field">
                <span>Heures de route</span>
                <input id="hoursInput" type="number" min="0" step="0.1" />
              </label>
              <label class="field">
                <span>Kilom√®tres</span>
                <input id="kmInput" type="number" min="0" step="1" />
              </label>
              <label class="field">
                <span>Budget route (essence + p√©ages)</span>
                <input id="roadCostInput" type="number" min="0" step="1" />
              </label>
            </div>
          </div>

          <div class="card inner">
            <h3>D√©penses du jour</h3>
            <div class="grid2">
              <label class="field">
                <span>Activit√©s</span>
                <input id="costActivities" type="number" min="0" step="1" />
              </label>
              <label class="field">
                <span>Logement</span>
                <input id="costLodging" type="number" min="0" step="1" />
              </label>
              <label class="field">
                <span>Nourriture</span>
                <input id="costFood" type="number" min="0" step="1" />
              </label>
              <label class="field">
                <span>Autre</span>
                <input id="costOther" type="number" min="0" step="1" />
              </label>
            </div>
            <div class="divider"></div>
            <h3>Logement (infos)</h3>
            <div class="grid2">
              <label class="field">
                <span>Nom / type</span>
                <input id="lodgingName" type="text" placeholder="Ex: Airbnb ‚Äì Studio centre" />
              </label>
              <label class="field">
                <span>Adresse / lien</span>
                <input id="lodgingLink" type="text" placeholder="https://..." />
              </label>
              <label class="field">
                <span>Check-in</span>
                <input id="lodgingCheckin" type="text" placeholder="Ex: 15:00" />
              </label>
              <label class="field">
                <span>Check-out</span>
                <input id="lodgingCheckout" type="text" placeholder="Ex: 11:00" />
              </label>
              <label class="field field--grow" style="grid-column: 1 / -1;">
                <span>Notes</span>
                <textarea id="lodgingNotes" rows="3" placeholder="Code porte, parking, etc."></textarea>
              </label>
            </div>

            <div class="divider"></div>
            <h3>Dossier (billets / r√©servations)</h3>
            <p class="muted small">Fichiers stock√©s dans Supabase Storage, dans un dossier par jour.</p>
            <div class="row">
              <input id="fileInput" type="file" multiple />
              <button id="btnUploadFiles" class="btn btn--secondary">Uploader</button>
            </div>
            <div id="filesList" class="list smalllist"></div>
          </div>
        </div>
      </section>
    </section>
  </main>

  <script src="config.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
  <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
  <script src="app_trip.js"></script>
</body>
</html>
